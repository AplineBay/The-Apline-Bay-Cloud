<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Apline Bay - Games Library</title>
  <meta name="description" content="The Apline Bay - A curated library of games and interactive experiences">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

  <!-- Styles -->
  <style>
    /* === RESET === */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* === VARIABLES === */
    :root {
      /* Vision OS Dark Theme */
      --background: 0 0% 8%;
      --background-secondary: 0 0% 12%;
      --background-tertiary: 0 0% 16%;
      --foreground: 0 0% 95%;
      --foreground-secondary: 0 0% 80%;
      --foreground-tertiary: 0 0% 65%;

      /* Blue Accent System */
      --blue-50: 210 100% 98%;
      --blue-100: 210 100% 95%;
      --blue-200: 210 100% 92%;
      --blue-300: 210 100% 86%;
      --blue-400: 210 91% 65%;
      --blue-500: 210 91% 55%;
      --blue-600: 210 81% 56%;
      --blue-700: 210 72% 47%;
      --blue-800: 210 69% 38%;
      --blue-900: 210 69% 32%;

      /* Glass Effects */
      --glass-bg: rgba(255, 255, 255, 0.05);
      --glass-border: rgba(255, 255, 255, 0.1);
      --glass-shadow: rgba(0, 0, 0, 0.3);

      /* Spacing */
      --spacing-xs: 4px;
      --spacing-sm: 8px;
      --spacing-md: 16px;
      --spacing-lg: 24px;
      --spacing-xl: 32px;
      --spacing-2xl: 48px;
      --spacing-3xl: 64px;

      /* Border Radius */
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 20px;
      --radius-2xl: 24px;
    }

    body {
      font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: hsl(var(--background));
      color: hsl(var(--foreground));
      min-height: 100vh;
      line-height: 1.5;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* === your CSS continues here === */
  </style>
</head>

<body>
  <!-- Background Effects -->
  <div class="vision-bg">
    <div class="vision-orb vision-orb-1"></div>
    <div class="vision-orb vision-orb-2"></div>
    <div class="vision-orb vision-orb-3"></div>
  </div>

  <!-- Main Content Container -->
  <div class="container">
    <header class="header">
      <div class="logo-container">
        <div class="logo-glow"></div>
        <img src="your-logo.png" alt="Logo" class="logo">
      </div>
      <h1 class="title">The Apline Bay</h1>
      <p class="subtitle">A curated library of games and interactive experiences.</p>
      <span class="version-badge">v1.0</span>
    </header>

    <!-- Search -->
    <div class="search-container">
      <div class="search-wrapper">
        <input type="text" class="search-input" placeholder="Search games...">
        <svg class="search-icon"><!-- icon here --></svg>
        <button class="clear-btn">✕</button>
      </div>
    </div>

    <!-- Content -->
    <section class="content">
      <div class="content-header">
        <h2 class="content-title">Games Library</h2>
        <span class="game-count">0 games</span>
      </div>

      <!-- Games Grid -->
      <div class="games-grid">
        <!-- Example Card -->
        <a href="#" class="game-card">
          <div class="card-content">
            <div class="card-header">
              <div class="card-info">
                <h3 class="card-title">Game Title</h3>
                <div class="card-platforms">
                  <span class="platform-badge">Windows</span>
                  <span class="platform-badge">Mac</span>
                </div>
              </div>
              <span class="card-arrow">→</span>
            </div>
            <div class="card-tags">
              <span class="tag">Action</span>
              <span class="tag">Multiplayer</span>
            </div>
          </div>
        </a>
      </div>
    </section>
  </div>

  <!-- Floating AI Button -->
  <a href="#" class="ai-fab">
    <svg><!-- icon --></svg>
    Ask AI
  </a>
</body>
</html>
    <div class="vision-bg">
        <div class="vision-orb vision-orb-1"></div>
        <div class="vision-orb vision-orb-2"></div>
        <div class="vision-orb vision-orb-3"></div>
    </div>

    <a href="https://talk.shapes.inc/aplinegg/dm" class="ai-fab" target="_blank" rel="noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-zap"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>
        <span>Ask Apline AI</span>
    </a>

    <main class="container">
        <header class="header">
            <div class="logo-container">
                <div class="logo-glow"></div>
                <img src="https://files.catbox.moe/mjmm60.png" alt="The Apline Bay Logo" class="logo">
            </div>
            <h1 class="title">The Apline Bay</h1>
            <p class="subtitle">A curated library of games and interactive experiences for various platforms.</p>
            <span class="version-badge">Version 2.0 Indev</span>
        </header>

        <section class="search-container">
            <div class="search-wrapper">
                <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                <input type="text" id="searchInput" class="search-input" placeholder="Search games...">
                <button id="clearSearchBtn" class="clear-btn" aria-label="Clear search">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
            </div>
        </section>

        <section id="games" class="content">
            <div class="content-header">
                <h2 class="content-title">All Games</h2>
                <div class="custom-select-wrapper">
                    <select id="seriesFilter" class="series-filter-select" aria-label="Filter by series">
                        <option value="All Series">All Series</option>
                    </select>
                    <div class="custom-select-trigger">
                        <span>All Series</span>
                        <svg class="arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                    </div>
                    <div class="custom-options">
                        </div>
                </div>
                <span class="game-count"><span id="displayedGameCount">0</span> of <span id="totalGameCount">0</span> games</span>
            </div>
            <div id="gamesGrid" class="games-grid">
                </div>
            <div id="emptyState" class="empty-state" style="display: none;">
                <div class="empty-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
                </div>
                <h3 class="empty-title">No Games Found</h3>
                <p class="empty-description">Try adjusting your search or filters. We might not have what you're looking for right now.</p>
            </div>
        </section>
    </main>

    <div id="loadingOverlay" class="loading" style="display: flex;">
        <div class="loading-content">
            <div class="loading-spinner">
                <div class="spinner-ring"></div>
            </div>
            <p class="loading-text">Loading Games...</p>
            <div class="loading-dots">
                <div class="loading-dot"></div>
                <div class="loading-dot"></div>
                <div class="loading-dot"></div>
            </div>
        </div>
    </div>

    <script>
        let allGames = [];
        let games = [];
        let currentSeriesFilter = 'All Series';
        let currentSearchQuery = '';

        const searchInput = document.getElementById('searchInput');
        const clearSearchBtn = document.getElementById('clearSearchBtn');
        const gamesGrid = document.getElementById('gamesGrid');
        const emptyState = document.getElementById('emptyState');
        const loadingOverlay = document.getElementById('loadingOverlay');
        const displayedGameCountSpan = document.getElementById('displayedGameCount');
        const totalGameCountSpan = document.getElementById('totalGameCount');
        
        // Custom Dropdown Elements
        const customSelectWrapper = document.querySelector('.custom-select-wrapper');
        const customSelectTrigger = customSelectWrapper.querySelector('.custom-select-trigger');
        const customOptionsContainer = customSelectWrapper.querySelector('.custom-options');
        const customSelectDisplay = customSelectTrigger.querySelector('span');

        document.addEventListener('DOMContentLoaded', () => {
            fetchGames();
            setupSearch();
            setupSeriesFilter();
        });

        async function fetchGames() {
            try {
                const response = await fetch('games.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                allGames = await response.json();
                games = [...allGames]; // Initialize games with all games
                console.log('Games loaded:', allGames); // Debugging
                populateSeriesFilter();
                updateGameCounts();
                filterAndDisplayGames();
                loadingOverlay.style.display = 'none'; // Hide loading overlay
            } catch (error) {
                console.error('Error fetching games:', error);
                loadingOverlay.style.display = 'none';
                emptyState.style.display = 'flex'; // Show empty state if games fail to load
                emptyState.querySelector('.empty-title').textContent = 'Error Loading Games';
                emptyState.querySelector('.empty-description').textContent = 'Could not load game data. Please try again later.';
            }
        }

        /**
         * Extracts the primary series name from a game title.
         * Handles various naming conventions like subtitles, numbered sequels, and editions.
         * @param {string} gameName The full name of the game.
         * @returns {string} The extracted series name.
         */
        function getGameSeries(gameName) {
            let series = gameName.trim();

            // Prioritize removing common subtitle/edition patterns using regex
            const regexPatterns = [
                // Matches "Series: Subtitle", "Series - Subtitle", "Series (Year)", "Series [Platform]"
                /:(\s*.*)$/,
                / - (\s*.*)$/,
                /\s*\((Year|Platform)\)$/, // (Year), (Platform)
                /\s*\[(Platform)\]$/, // [Platform]

                // Matches common edition/version suffixes
                /\s+(Remastered|Remaster|Ultimate|Definitive|Gold|GOTY|Game of the Year|Edition|Season|Chapter|Part)\s*.*$/i,
                
                // Matches words like 'Online' or 'Mobile' if they appear at the end and seem like a sub-identifier
                /\s+(Online|Mobile)$/i,

                // Matches simple numbers/roman numerals that often denote sequels, but *only if* they are followed by nothing or just spaces.
                // This is to be handled more robustly by the numerical series logic below.
            ];

            for (const pattern of regexPatterns) {
                series = series.replace(pattern, '').trim();
            }

            // Handle numerical sequels (e.g., Grand Theft Auto V, Call of Duty 4)
            // This regex tries to capture the part *before* a space followed by a number or Roman numeral.
            // It's designed to be non-greedy to capture the shortest possible series name first.
            let matchNumericSequel = series.match(/^(.*?)(?:\s+(?:V|IV|III|II|I|\d+))(?:\s.*)?$/i);
            if (matchNumericSequel) {
                // Check if the matched number is truly a version number and not part of the name (e.g., 'Project IGI 2')
                // For simplicity, we assume if a direct number/roman numeral follows the likely series, it's a version.
                series = matchNumericSequel[1].trim();
            }

            // A final cleanup for any trailing numbers not caught by the sequel logic (e.g. 'FIFA 23')
            series = series.replace(/\s+\d{2,4}$/, '').trim(); // Remove 2-4 digit years/numbers at the very end

            // Special handling for cases where stripping might make it too short or incorrect
            // These ensure consistency for well-known series if the regex is too aggressive.
            const specificSeriesOverrides = {
                'grand theft auto': 'Grand Theft Auto',
                'call of duty': 'Call of Duty',
                'need for speed': 'Need for Speed',
                // Add more as needed if you notice specific series not being correctly grouped
            };

            for (const key in specificSeriesOverrides) {
                if (series.toLowerCase().startsWith(key)) {
                    series = specificSeriesOverrides[key];
                    break; // Apply the first matching override and stop
                }
            }


            // Capitalize the first letter of each word to ensure consistent display
            series = series.split(' ').map(word => {
                if (word.length === 0) return '';
                // Handle common conjunctions/prepositions in lowercase for better aesthetics
                const lowercaseWords = ['of', 'the', 'for', 'and', 'a', 'an'];
                if (lowercaseWords.includes(word.toLowerCase()) && word.toLowerCase() !== series.toLowerCase().split(' ')[0].toLowerCase()) {
                    return word.toLowerCase();
                }
                return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();
            }).join(' ');

            return series;
        }

        function populateSeriesFilter() {
            const uniqueSeries = new Set();
            allGames.forEach(game => {
                const series = getGameSeries(game.name);
                uniqueSeries.add(series);
            });

            const sortedSeries = Array.from(uniqueSeries).sort();
            console.log('Unique series found:', sortedSeries); // Debugging

            // Clear existing custom options, keeping "All Series"
            customOptionsContainer.innerHTML = ''; 

            // Add "All Series" option
            const allSeriesOption = document.createElement('div');
            allSeriesOption.classList.add('custom-option');
            allSeriesOption.dataset.value = 'All Series';
            allSeriesOption.textContent = 'All Series';
            allSeriesOption.classList.add('selected'); // Default selected
            customOptionsContainer.appendChild(allSeriesOption);

            sortedSeries.forEach(series => {
                const optionElement = document.createElement('div');
                optionElement.classList.add('custom-option');
                optionElement.dataset.value = series;
                optionElement.textContent = series;
                customOptionsContainer.appendChild(optionElement);
            });

            // Re-attach event listeners for custom options
            customOptionsContainer.querySelectorAll('.custom-option').forEach(option => {
                option.addEventListener('click', () => {
                    const value = option.dataset.value;
                    customSelectDisplay.textContent = option.textContent;
                    currentSeriesFilter = value;

                    // Update selected class
                    customOptionsContainer.querySelectorAll('.custom-option').forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');

                    customOptionsContainer.classList.remove('open');
                    customSelectTrigger.classList.remove('active');
                    filterAndDisplayGames();
                });
            });
        }

        function setupSeriesFilter() {
            customSelectTrigger.addEventListener('click', () => {
                customOptionsContainer.classList.toggle('open');
                customSelectTrigger.classList.toggle('active');
            });

            document.addEventListener('click', (e) => {
                if (!customSelectWrapper.contains(e.target) && customOptionsContainer.classList.contains('open')) {
                    customOptionsContainer.classList.remove('open');
                    customSelectTrigger.classList.remove('active');
                }
            });
        }

        function setupSearch() {
            searchInput.addEventListener('input', (e) => {
                currentSearchQuery = e.target.value.toLowerCase();
                clearSearchBtn.classList.toggle('visible', currentSearchQuery.length > 0);
                filterAndDisplayGames();
            });

            clearSearchBtn.addEventListener('click', () => {
                searchInput.value = '';
                currentSearchQuery = '';
                clearSearchBtn.classList.remove('visible');
                filterAndDisplayGames();
            });
        }

        function filterAndDisplayGames() {
            let filteredGames = allGames;

            if (currentSeriesFilter !== 'All Series') {
                filteredGames = filteredGames.filter(game => getGameSeries(game.name) === currentSeriesFilter);
            }

            if (currentSearchQuery) {
                filteredGames = filteredGames.filter(game =>
                    game.name.toLowerCase().includes(currentSearchQuery) ||
                    game.description.toLowerCase().includes(currentSearchQuery) ||
                    game.versions.some(version =>
                        version.platform.toLowerCase().includes(currentSearchQuery) ||
                        version.tags.some(tag => tag.toLowerCase().includes(currentSearchQuery))
                    )
                );
            }

            displayGames(filteredGames);
            displayedGameCountSpan.textContent = filteredGames.length;
            totalGameCountSpan.textContent = allGames.length;

            if (filteredGames.length === 0) {
                emptyState.style.display = 'flex';
                emptyState.querySelector('.empty-title').textContent = 'No Games Found';
                emptyState.querySelector('.empty-description').textContent = 'Try adjusting your search or filters. We might not have what you\'re looking for right now.';
            } else {
                emptyState.style.display = 'none';
            }
        }

        function displayGames(gamesToDisplay) {
            gamesGrid.innerHTML = '';
            if (gamesToDisplay.length === 0) {
                return;
            }
        
            gamesToDisplay.forEach(game => {
                const gameCard = document.createElement('a');
                gameCard.href = `game-details.html?slug=${game.slug}`; // ✅ link to game details
                gameCard.classList.add('game-card');
        
                gameCard.innerHTML = `
                    <div class="card-content">
                        <div class="card-header">
                            <div class="card-info">
                                <h3 class="card-title">${game.name}</h3>
                                <div class="card-platforms">
                                    ${game.versions
                                        .map(v => `<span class="platform-badge">${v.platform}</span>`)
                                        .join('')}
                                </div>
                            </div>
                            <svg class="card-arrow" xmlns="http://www.w3.org/2000/svg" 
                                 width="24" height="24" viewBox="0 0 24 24" fill="none" 
                                 stroke="currentColor" stroke-width="2" 
                                 stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </div>
                        <p>${game.description}</p>
                        <div class="card-tags">
                            ${Array.from(
                                new Set(game.versions.flatMap(v => v.tags || []))
                            )
                                .map(tag => `<span class="tag">${tag}</span>`)
                                .join('')}
                        </div>
                    </div>
                `;
        
                gamesGrid.appendChild(gameCard);
            });
        }
        
        function updateGameCounts() {
            totalGameCountSpan.textContent = allGames.length;
        }
   </script>
</body>
</html>










